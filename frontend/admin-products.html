<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Admin ‚Äì Qu·∫£n l√Ω c·ª≠a h√†ng</title>
  <link rel="stylesheet" href="assets/base.css">
  <style>
    .wrap{max-width:1100px;margin:0 auto;padding:16px}
    .tabs{display:flex;gap:8px;margin:8px 0 14px}
    .tab{padding:8px 12px;border:1px solid var(--bd);border-radius:10px;background:#fff;cursor:pointer;font-weight:700}
    .tab.active{background:#111;color:#fff;border-color:#111}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:16px}
    @media(max-width:900px){.grid{grid-template-columns:1fr}}
    .card{background:#fff;border:1px solid var(--bd);border-radius:12px;padding:14px}
    .form-row{margin:8px 0}
    .form-row input,.form-row select{width:100%;padding:10px;border:1px solid var(--bd);border-radius:10px;background:#fff}
    table{width:100%;border-collapse:collapse;background:#fff;border:1px solid var(--bd);border-radius:12px;overflow:hidden}
    th,td{padding:10px;border-bottom:1px solid var(--bd);text-align:left}
    .chip{display:inline-block;padding:4px 8px;border:1px solid var(--bd);border-radius:999px;font-size:12px;background:#fff}
    .actions{display:flex;gap:8px}
    .ghost.small{padding:6px 10px;font-size:13px;border-radius:8px}
    .hidden{display:none}
  </style>
</head>
<body>
  <!-- Header chu·∫©n -->
  <header>
    <a href="index.html"><strong>üè™ Sports Shop</strong></a>
    <nav>
      <a href="sports.html">B·ªô m√¥n</a>
      <a href="sale.html">Gi·∫£m gi√°</a>
      <a id="navAdmin" href="admin-products.html">Admin</a>
    </nav>
    <div class="header-right">
      <form class="search" action="search.html" method="get">
        <input name="q" placeholder="T√¨m ki·∫øm s·∫£n ph·∫©m..."><button>T√¨m</button>
      </form>
      <div class="account-wrap">
        <button id="accountBtn" class="icon-btn" aria-haspopup="menu" aria-expanded="false" aria-label="T√†i kho·∫£n">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path stroke="currentColor" stroke-width="1.6" d="M20 21a8 8 0 1 0-16 0m8-9a5 5 0 1 0 0-10 5 5 0 0 0 0 10Z"/>
          </svg>
        </button>
        <div class="account-menu">
          <a class="account-item" href="account.html">Trang c√° nh√¢n</a>
          <a class="account-item" href="cart.html">Gi·ªè h√†ng <span id="cartCount" class="badge-num">0</span></a>
          <a class="account-item" href="wishlist.html">Wishlist <span id="wishCount" class="badge-num">0</span></a>
          <div class="hr"></div>
          <a id="loginItem" class="account-item" href="login.html">ƒêƒÉng nh·∫≠p</a>
          <a id="registerItem" class="account-item" href="register.html">ƒêƒÉng k√Ω</a>
          <a id="logoutItem" class="account-item" href="#">ƒêƒÉng xu·∫•t</a>
        </div>
      </div>
    </div>
  </header>

  <main class="wrap">
    <h1>B·∫£ng ƒëi·ªÅu khi·ªÉn Admin</h1>
    <p class="muted">
      

    <!-- Tabs -->
    <div class="tabs">
      <button class="tab active" data-tab="products">S·∫£n ph·∫©m</button>
      <button class="tab" data-tab="orders">ƒê∆°n h√†ng</button>
      <button class="tab" data-tab="coupons">M√£ gi·∫£m gi√°</button>
    </div>

    <!-- PRODUCTS -->
    <section id="tab-products">
      <div class="grid">
        <div class="card">
          <h2>Th√™m s·∫£n ph·∫©m</h2> <!-- ƒë√£ b·ªè ch·ªØ / S·ª≠a -->
          <form id="prodForm">
            <input type="hidden" name="editingIndex" value="-1">
            <div class="form-row"><input name="name" placeholder="T√™n s·∫£n ph·∫©m" required></div>
            <div class="form-row"><input name="price" type="number" placeholder="Gi√° (ƒë)" required></div>
            <div class="form-row">
              <select name="category" required>
                <option value="running">Ch·∫°y</option>
                <option value="trekking">Trekking</option>
                <option value="camping">Camping</option>
                <option value="basketball">B√≥ng r·ªï</option>
                <option value="football">B√≥ng ƒë√°</option>
                <option value="badminton">C·∫ßu l√¥ng</option>
              </select>
            </div>
            <div class="form-row"><input name="stock" type="number" min="0" placeholder="T·ªìn kho"></div>
            <div class="form-row"><input name="img" placeholder="URL ·∫£nh (tu·ª≥ ch·ªçn)"></div>
            <button class="ghost" id="btnSaveProd" type="submit" style="width:100%">L∆∞u s·∫£n ph·∫©m</button>
          </form>
        </div>

        <div class="card">
          <h2>Danh s√°ch s·∫£n ph·∫©m</h2>
          <table id="prodTable">
            <thead><tr><th>ID</th><th>T√™n</th><th>Gi√°</th><th>Danh m·ª•c</th><th>T·ªìn</th><th></th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- ORDERS -->
    <section id="tab-orders" class="hidden">
      <div class="card">
        <h2>ƒê∆°n h√†ng</h2>
        <table id="orderTable">
          <thead><tr><th>M√£</th><th>Ng√†y</th><th>Kh√°ch</th><th>T·ªïng</th><th>Tr·∫°ng th√°i</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <!-- COUPONS -->
    <section id="tab-coupons" class="hidden">
      <div class="grid">
        <div class="card">
          <h2>Th√™m m√£ gi·∫£m gi√°</h2>
          <form id="couponForm">
            <input type="hidden" name="editingIndex" value="-1">
            <div class="form-row"><input name="code" placeholder="M√£ (VD: GIA10)" required></div>
            <div class="form-row">
              <select name="type" required>
                <option value="percent">Ph·∫ßn trƒÉm (%)</option>
                <option value="fixed">S·ªë ti·ªÅn (ƒë)</option>
              </select>
            </div>
            <div class="form-row"><input name="value" type="number" placeholder="Gi√° tr·ªã (VD: 10 ho·∫∑c 50000)" required></div>
            <div class="form-row"><input name="min" type="number" placeholder="ƒê∆°n t·ªëi thi·ªÉu ƒë·ªÉ √°p d·ª•ng (ƒë)"></div>
            <div class="form-row"><input name="expire" type="date" placeholder="Ng√†y h·∫øt h·∫°n"></div>
            <div class="form-row">
              <select name="active">
                <option value="true">ƒêang b·∫≠t</option>
                <option value="false">T·∫Øt</option>
              </select>
            </div>
            <button class="ghost" id="btnSaveCoupon" type="submit" style="width:100%">L∆∞u m√£</button>
          </form>
        </div>

        <div class="card">
          <h2>Danh s√°ch m√£ gi·∫£m gi√°</h2>
          <table id="couponTable">
            <thead><tr><th>M√£</th><th>Lo·∫°i</th><th>Gi√° tr·ªã</th><th>T·ªëi thi·ªÉu</th><th>H·∫øt h·∫°n</th><th>Tr·∫°ng th√°i</th><th></th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>
  </main>

  <footer>¬© 2025 Sports Shop ‚Äî <a href="policy-contact.html">Ch√≠nh s√°ch & Li√™n h·ªá</a></footer>

  <script src="assets/app.js"></script>
  <script>
    // ======= local helpers =======
    const qs=(s,r=document)=>r.querySelector(s), qsa=(s,r=document)=>[...r.querySelectorAll(s)];
    const get=(k,fb)=>{try{const v=localStorage.getItem(k);return v?JSON.parse(v):fb}catch{return fb}};
    const set=(k,v)=>localStorage.setItem(k,JSON.stringify(v));
    const money=n=>(Number(n)||0).toLocaleString('vi-VN')+'ƒë';

    // ======= Tabs (S·∫£n ph·∫©m / ƒê∆°n h√†ng / M√£ gi·∫£m gi√°) =======
    qsa('.tab').forEach(b=>{
      b.addEventListener('click',()=>{
        qsa('.tab').forEach(x=>x.classList.remove('active'));
        b.classList.add('active');
        const name=b.dataset.tab;
        qsa('main section').forEach(s=>s.classList.add('hidden'));
        qs('#tab-'+name).classList.remove('hidden');
      });
    });

    // ======= PRODUCTS =======
    function loadProducts(){ return get('admin_products', []); }
    function saveProducts(list){ set('admin_products', list); renderProducts(); }

    function renderProducts(){
      const tb = qs('#prodTable tbody'); tb.innerHTML='';
      const list = loadProducts();
      list.forEach((p,idx)=>{
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>#${idx+1}</td>
          <td>${p.name}</td>
          <td>${money(p.price)}</td>
          <td><span class="chip">${p.category}</span></td>
          <td>${p.stock||0}</td>
          <td class="actions">
            <button class="ghost small" data-act="edit" data-idx="${idx}">S·ª≠a</button>
            <button class="ghost small" data-act="del" data-idx="${idx}">X√≥a</button>
          </td>`;
        tb.appendChild(tr);
      });
    }

    qs('#prodForm').addEventListener('submit', e=>{
      e.preventDefault();
      const f = e.target;
      const data = {
        name: f.name.value.trim(),
        price: Number(f.price.value||0),
        category: f.category.value,
        stock: Number(f.stock.value||0),
        img: f.img.value.trim()
      };
      const idx = Number(f.editingIndex.value||-1);
      const list = loadProducts();
      if (idx>=0){ list[idx]=data; qs('#btnSaveProd').textContent='L∆∞u s·∫£n ph·∫©m'; }
      else list.push(data);
      f.reset(); f.editingIndex.value=-1;
      saveProducts(list);
    });

    qs('#prodTable').addEventListener('click', e=>{
      const btn = e.target.closest('button'); if(!btn) return;
      const idx = Number(btn.dataset.idx);
      const list = loadProducts();
      if (btn.dataset.act==='edit'){
        const p = list[idx], f = qs('#prodForm');
        f.name.value=p.name; f.price.value=p.price; f.category.value=p.category;
        f.stock.value=p.stock||0; f.img.value=p.img||''; f.editingIndex.value=idx;
        qs('#btnSaveProd').textContent='C·∫≠p nh·∫≠t';
        window.scrollTo({top:0, behavior:'smooth'});
      } else if (btn.dataset.act==='del'){
        if(confirm('X√≥a s·∫£n ph·∫©m n√†y?')){ list.splice(idx,1); saveProducts(list); }
      }
    });

    // ======= ORDERS (ƒë·ªçc t·ª´ localStorage 'orders') =======
    function renderOrders(){
      const tb = qs('#orderTable tbody'); tb.innerHTML='';
      const orders = get('orders', []); // {id,date,customer,total,status}
      orders.forEach(o=>{
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${o.id}</td><td>${o.date}</td><td>${o.customer||'-'}</td>
                        <td>${money(o.total||0)}</td><td>${o.status||'pending'}</td>`;
        tb.appendChild(tr);
      });
    }

    // ======= COUPONS =======
    function loadCoupons(){ return get('coupons', []); }
    function saveCoupons(list){ set('coupons', list); renderCoupons(); }

    function renderCoupons(){
      const tb = qs('#couponTable tbody'); tb.innerHTML='';
      loadCoupons().forEach((c,idx)=>{
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${c.code}</td>
          <td>${c.type==='percent'?'%':'ƒë'}</td>
          <td>${c.type==='percent'? (c.value+'%'): money(c.value)}</td>
          <td>${c.min?money(c.min):'-'}</td>
          <td>${c.expire||'-'}</td>
          <td>${c.active?'ƒêang b·∫≠t':'T·∫Øt'}</td>
          <td class="actions">
            <button class="ghost small" data-cact="edit" data-idx="${idx}">S·ª≠a</button>
            <button class="ghost small" data-cact="toggle" data-idx="${idx}">${c.active?'T·∫Øt':'B·∫≠t'}</button>
            <button class="ghost small" data-cact="del" data-idx="${idx}">X√≥a</button>
          </td>`;
        tb.appendChild(tr);
      });
    }

    qs('#couponForm').addEventListener('submit', e=>{
      e.preventDefault();
      const f=e.target;
      const data={
        code:f.code.value.trim().toUpperCase(),
        type:f.type.value,
        value:Number(f.value.value||0),
        min:Number(f.min.value||0),
        expire:f.expire.value||'',
        active:f.active.value==='true'
      };
      const idx=Number(f.editingIndex.value||-1);
      const list=loadCoupons();
      if(idx>=0){ list[idx]=data; qs('#btnSaveCoupon').textContent='L∆∞u m√£'; }
      else list.push(data);
      f.reset(); f.editingIndex.value=-1;
      saveCoupons(list);
    });

    qs('#couponTable').addEventListener('click', e=>{
      const b=e.target.closest('button'); if(!b) return;
      const idx=Number(b.dataset.idx);
      const list=loadCoupons();
      if(b.dataset.cact==='edit'){
        const c=list[idx], f=qs('#couponForm');
        f.code.value=c.code; f.type.value=c.type; f.value.value=c.value;
        f.min.value=c.min||0; f.expire.value=c.expire||''; f.active.value=c.active?'true':'false';
        f.editingIndex.value=idx; qs('#btnSaveCoupon').textContent='C·∫≠p nh·∫≠t';
        window.scrollTo({top:0,behavior:'smooth'});
      } else if(b.dataset.cact==='toggle'){
        list[idx].active=!list[idx].active; saveCoupons(list);
      } else if(b.dataset.cact==='del'){
        if(confirm('X√≥a m√£ n√†y?')){ list.splice(idx,1); saveCoupons(list); }
      }
    });

    // ======= Init =======
    document.addEventListener('DOMContentLoaded', ()=>{
      // n·∫øu demo ch∆∞a c√≥ sp: seed
      if(!localStorage.getItem('admin_products')){
        set('admin_products',[
          {name:'Gi√†y ch·∫°y 5K',price:990000,category:'running',stock:20,img:''},
          {name:'√Åo Jersey Chicago',price:790000,category:'basketball',stock:15,img:''},
        ]);
      }
      renderProducts();
      renderOrders();
      renderCoupons();
    });
  </script>
</body>
</html>
