<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Thanh toÃ¡n - Sports Shop</title>
  <link rel="stylesheet" href="assets/base.css">
  <script defer src="assets/app.js"></script>
  <style>
    .co-wrap{max-width:1100px;margin:0 auto;padding:16px}
    .co-grid{display:grid;grid-template-columns:2fr 1fr;gap:18px}
    @media(max-width:900px){.co-grid{grid-template-columns:1fr}}
    .card{background:#fff;border:1px solid var(--bd);border-radius:12px;padding:14px}
    .form-row{margin:8px 0}
    .form-row input,.form-row select{width:100%;padding:10px;border:1px solid var(--bd);border-radius:10px;background:#fff}
    .sum-row{display:flex;justify-content:space-between;margin:6px 0}
    .btn-primary{display:block;text-align:center;background:#111;color:#fff;padding:12px;border-radius:10px;margin-top:10px}
  </style>
</head>
<body>
  <!-- Header -->
  <header>
    <a href="index.html"><strong>ğŸª Sports Shop</strong></a>
    <nav>
      <a href="sports.html">Bá»™ mÃ´n</a>
      <a href="sale.html">Giáº£m giÃ¡</a>
      <a id="navAdmin" href="admin-products.html" style="display:none">Admin</a>
    </nav>
    <div class="header-right">
      <form class="search" action="search.html"><input name="q" placeholder="TÃ¬m kiáº¿m sáº£n pháº©m..."><button>TÃ¬m</button></form>
      <div class="account-wrap">
        <button id="accountBtn" class="icon-btn" aria-haspopup="menu" aria-expanded="false" aria-label="TÃ i khoáº£n">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path stroke="currentColor" stroke-width="1.6" d="M20 21a8 8 0 1 0-16 0m8-9a5 5 0 1 0 0-10 5 5 0 0 0 0 10Z"/>
          </svg>
        </button>
        <div class="account-menu">
          <a class="account-item" href="account.html">Trang cÃ¡ nhÃ¢n</a>
          <a class="account-item" href="cart.html">Giá» hÃ ng <span id="cartCount" class="badge-num">0</span></a>
          <a class="account-item" href="wishlist.html">Wishlist <span id="wishCount" class="badge-num">0</span></a>
          <div class="hr"></div>
          <a id="loginItem" class="account-item" href="login.html">ÄÄƒng nháº­p</a>
          <a id="registerItem" class="account-item" href="register.html">ÄÄƒng kÃ½</a>
          <a id="logoutItem" class="account-item" href="#">ÄÄƒng xuáº¥t</a>
        </div>
      </div>
    </div>
  </header>

  <main class="co-wrap">
    <h1>Thanh toÃ¡n</h1>
    <div class="co-grid">
      <!-- BÃªn trÃ¡i: Form -->
      <form class="card" id="coForm">
        <h2>Äá»‹a chá»‰ nháº­n hÃ ng</h2>
        <div class="form-row"><input name="name" placeholder="Há» tÃªn" required></div>
        <div class="form-row"><input name="phone" placeholder="Sá»‘ Ä‘iá»‡n thoáº¡i" required></div>
        <div class="form-row"><input name="addr" placeholder="Äá»‹a chá»‰ (Sá»‘ nhÃ , Ä‘Æ°á»ng...)" required></div>
        <div class="form-row"><input name="district" placeholder="Quáº­n/Huyá»‡n" required></div>
        <div class="form-row">
          <select id="province" name="province" required>
            <option value="">-- Chá»n tá»‰nh/thÃ nh phá»‘ --</option>
            <option value="HÃ  Ná»™i">HÃ  Ná»™i</option>
            <option value="TP HCM">TP HCM</option>
            <option value="ÄÃ  Náºµng">ÄÃ  Náºµng</option>
            <option value="Háº£i PhÃ²ng">Háº£i PhÃ²ng</option>
            <option value="KhÃ¡c">Tá»‰nh khÃ¡c</option>
          </select>
        </div>
        <h3>PhÆ°Æ¡ng thá»©c thanh toÃ¡n</h3>
        <div class="form-row">
          <select name="method">
            <option>COD (Thanh toÃ¡n khi nháº­n)</option>
            <option>Chuyá»ƒn khoáº£n</option>
          </select>
        </div>
        <p style="font-size:12px;color:#555">LÆ°u Ã½: ÄÃ¢y lÃ  báº£n demo. ÄÆ¡n hÃ ng Ä‘Æ°á»£c lÆ°u local.</p>
        <button class="btn-primary" type="submit">Äáº·t hÃ ng</button>
      </form>

      <!-- BÃªn pháº£i: TÃ³m táº¯t -->
      <aside class="card">
        <h2>ÄÆ¡n hÃ ng</h2>
        <div id="coList" style="margin-bottom:10px"></div>
        <div style="display:flex;gap:4px;margin:8px 0;">
          <input id="couponInput" placeholder="Nháº­p mÃ£ giáº£m giÃ¡ (VD: GIA10)" style="flex:1;padding:8px;border:1px solid var(--bd);border-radius:8px">
          <button type="button" id="applyCoupon" style="padding:8px 12px;border:none;border-radius:8px;background:#111;color:#fff">Ãp dá»¥ng</button>
        </div>
        <div class="sum-row"><span>Táº¡m tÃ­nh</span><span id="coSubtotal">0Ä‘</span></div>
        <div class="sum-row"><span>Giáº£m giÃ¡</span><span id="coDiscount">-0Ä‘</span></div>
        <div class="sum-row"><span>PhÃ­ váº­n chuyá»ƒn</span><span id="coShip">0Ä‘</span></div>
        <div class="sum-row" style="font-weight:900"><span>Tá»•ng cá»™ng</span><span id="coTotal">0Ä‘</span></div>
      </aside>
    </div>
  </main>

  <footer>Â© 2025 Sports Shop â€” <a href="policy-contact.html">ChÃ­nh sÃ¡ch & LiÃªn há»‡</a></footer>

  <script>
    (function(){
      const fmt = n => (Number(n)||0).toLocaleString('vi-VN')+'Ä‘';
      const cart = JSON.parse(localStorage.getItem('cart')||'[]');
      const listEl = document.getElementById('coList');
      const subEl = document.getElementById('coSubtotal');
      const disEl = document.getElementById('coDiscount');
      const shipEl = document.getElementById('coShip');
      const totalEl = document.getElementById('coTotal');
      const provinceEl = document.getElementById('province');
      const couponInput = document.getElementById('couponInput');
      const applyBtn = document.getElementById('applyCoupon');

      let subtotal = cart.reduce((s,i)=>s+i.price*i.qty,0);
      let discount = 0;
      let ship = 0;

      function renderList(){
        listEl.innerHTML = cart.map(i=>`
          <div style="display:flex;justify-content:space-between;margin:4px 0">
            <span>${i.name} Ã— ${i.qty}</span>
            <span>${fmt(i.price*i.qty)}</span>
          </div>`).join('');
        updateTotal();
      }

      function updateTotal(){
        subEl.textContent = fmt(subtotal);
        disEl.textContent = discount>0?('-'+fmt(discount)):'-0Ä‘';
        shipEl.textContent = ship>0?fmt(ship):'Miá»…n phÃ­';
        totalEl.textContent = fmt(subtotal - discount + ship);
      }

      // Ãp dá»¥ng mÃ£ giáº£m giÃ¡
      applyBtn.addEventListener('click',()=>{
        const code = couponInput.value.trim().toUpperCase();
        if(code === 'GIA10'){
          discount = Math.round(subtotal*0.1);
          alert('Ãp dá»¥ng mÃ£ giáº£m giÃ¡ 10% thÃ nh cÃ´ng!');
        }else{
          discount = 0;
          alert('MÃ£ khÃ´ng há»£p lá»‡.');
        }
        updateTotal();
      });

      // PhÃ­ ship theo tá»‰nh
      provinceEl.addEventListener('change',()=>{
        const val = provinceEl.value;
        if(val==='HÃ  Ná»™i' || val==='TP HCM') ship = 30000;
        else if(val==='ÄÃ  Náºµng' || val==='Háº£i PhÃ²ng') ship = 40000;
        else ship = 50000;
        updateTotal();
      });

      document.getElementById('coForm').addEventListener('submit',e=>{
        e.preventDefault();
        if(cart.length===0){ alert('Giá» hÃ ng trá»‘ng.'); return; }
        alert('Äáº·t hÃ ng thÃ nh cÃ´ng! ğŸ‰');
        localStorage.setItem('cart','[]');
        location.href='account.html';
      });

      renderList();
    })();
  </script>
</body>
</html>
